<!doctype html>
<html lang="es">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="exe_highlighter.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>4.- Entrada basada en formularios. Inyección. Validación de la entrada. | UD 3: Detección y corrección de vulnerabilidades en aplicaciones web </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta name="author" content="Pedro Antonio Santiago Santiago y José Gaspar Sánchez García" />
<meta name="generator" content="eXeLearning 2.6 - exelearning.net" />
<!--[if lt IE 9]><script type="text/javascript" src="exe_html5.js"></script><![endif]-->
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="exe_highlighter.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="exe-web-site" id="exe-node-60"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<header id="header" ><div id="headerContent">UD 3: Detección y corrección de vulnerabilidades en aplicaciones web</div></header>
<nav id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">UD3. DETECCIÓN Y CORRECCIÓN DE VULNERABILIDADES DE APLICACIONES WEB</a></li>
   <li><a href="objetivos.html" class="no-ch">Objetivos</a></li>
   <li><a href="introduccin.html" class="no-ch">Introducción</a></li>
   <li><a href="1_protocolo_http.html" class="daddy">1.- Protocolo HTTP.</a>
   <ul class="other-section">
      <li><a href="11_formato_del_mensaje_http.html" class="no-ch">1.1.- Formato del mensaje HTTP.</a></li>
      <li><a href="12_versiones_del_protocolo.html" class="no-ch">1.2.- Versiones del protocolo.</a></li>
      <li><a href="13_tecnologas_web.html" class="no-ch">1.3. -Tecnologías Web.</a></li>
   </ul>
   </li>
   <li><a href="2desarrollo_seguro_de_aplicaciones_web.html" class="no-ch">2.-Desarrollo seguro de aplicaciones web.</a></li>
   <li><a href="3_listas_pblicas_de_vulnerabilidades_de_aplicaciones_web_owasp_top_ten.html" class="daddy">3.- Listas públicas de vulnerabilidades de aplicaciones web. OWASP Top Ten.</a>
   <ul class="other-section">
      <li><a href="31__inyeccin.html" class="no-ch">3.1. - Inyección.</a></li>
      <li><a href="32__prdida_de_autenticacin.html" class="no-ch">3.2. - Pérdida de autenticación.</a></li>
      <li><a href="33__exposicin_de_datos_sensibles.html" class="no-ch">3.3. - Exposición de datos sensibles.</a></li>
      <li><a href="34__entidades_externas_xml_xxe.html" class="no-ch">3.4. - Entidades externas XML (XXE).</a></li>
      <li><a href="35_prdida_de_control_de_acceso.html" class="no-ch">3.5. -Pérdida de Control de Acceso.</a></li>
      <li><a href="36_configuracin_de_seguridad_incorrecta.html" class="no-ch">3.6. -Configuración de seguridad incorrecta.</a></li>
      <li><a href="37__crosssite_scriptingxss.html" class="no-ch">3.7. - Cross-Site Scripting(XSS).</a></li>
      <li><a href="38__deserializacin_insegura.html" class="no-ch">3.8. - Deserialización insegura.</a></li>
      <li><a href="39__componentes_con_vulnerabilidades_conocidas.html" class="no-ch">3.9. - Componentes con vulnerabilidades conocidas.</a></li>
      <li><a href="310__registro_y_monitoreo_insuficientes.html" class="no-ch">3.10. - Registro y monitoreo insuficientes.</a></li>
   </ul>
   </li>
   <li id="active"><a href="4_entrada_basada_en_formularios_inyeccin_validacin_de_la_entrada.html" class="active daddy">4.- Entrada basada en formularios. Inyección. Validación de la entrada.</a>
   <ul>
      <li><a href="41__validacin_en_el_cliente.html" class="daddy">4.1. - Validación en el cliente.</a>
      <ul class="other-section">
         <li><a href="411_ejemplo_prctico_con_angular.html" class="no-ch">4.1.1.- Ejemplo práctico con Angular.</a></li>
      </ul>
      </li>
      <li><a href="42__validacin_en_el_servidor.html" class="daddy">4.2. - Validación en el servidor.</a>
      <ul class="other-section">
         <li><a href="421_ejemplo_prctico_con_nodejs.html" class="no-ch">4.2.1.- Ejemplo práctico con NodeJs</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="5__estndares_de_autenticacin_y_autorizacin.html" class="daddy">5. - Estándares de autenticación y autorización.</a>
   <ul class="other-section">
      <li><a href="51__elementos_de_un_sistema_de_autenticacin_y_autorizacin_bsico.html" class="no-ch">5.1. - Elementos de un sistema de autenticación y autorización básico.</a></li>
      <li><a href="52__estndares.html" class="daddy">5.2. - Estándares.</a>
      <ul class="other-section">
         <li><a href="521__tokens_jwt.html" class="daddy">5.2.1. - Tokens JWT</a>
         <ul class="other-section">
            <li><a href="5211__ejemplo_prctico_con_nodejs.html" class="no-ch">5.2.1.1. - Ejemplo práctico con NodeJs.</a></li>
         </ul>
         </li>
         <li><a href="522__oath.html" class="no-ch">5.2.2. - OAth.</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="6__robo_de_sesin.html" class="no-ch">6. - Robo de sesión.</a></li>
   <li><a href="7__almacenamiento_seguro_de_contraseas.html" class="daddy">7. - Almacenamiento seguro de contraseñas.</a>
   <ul class="other-section">
      <li><a href="71_ejemplo_almacenamiento_seguro_nodejs.html" class="no-ch">7.1.- Ejemplo almacenamiento seguro NodeJs.</a></li>
   </ul>
   </li>
   <li><a href="8__contramedidas_hsts_csp_captchas_entre_otros.html" class="daddy">8. - Contramedidas. HSTS, CSP, CAPTCHAs, entre otros.</a>
   <ul class="other-section">
      <li><a href="81__hsts_http_strict_transport_security.html" class="no-ch">8.1. - HSTS (HTTP Strict Transport Security)</a></li>
      <li><a href="82__csp_content_security_policy.html" class="no-ch">8.2. - CSP (Content Security Policy)</a></li>
      <li><a href="83__captchas.html" class="no-ch">8.3. - CAPTCHAs</a></li>
   </ul>
   </li>
   <li><a href="9__seguridad_de_portales_y_aplicativos_web_soluciones_wafweb_application_firewall.html" class="no-ch">9. - Seguridad de portales y aplicativos web. Soluciones WAF(Web Application Firewall).</a></li>
   <li><a href="caso_prctico.html" class="no-ch">Caso práctico.</a></li>
   <li><a href="glosario.html" class="no-ch">Glosario</a></li>
   <li><a href="bibliografa.html" class="no-ch">Bibliografía</a></li>
   <li><a href="resumen.html" class="no-ch">Resumen</a></li>
</ul>
</nav>
<div id='topPagination'>
<nav class="pagination noprt">
<a href="310__registro_y_monitoreo_insuficientes.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="41__validacin_en_el_cliente.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
<div id="main-wrapper">
<section id="main">
<header id="nodeDecoration"><h1 id="nodeTitle">4.- Entrada basada en formularios. Inyección. Validación de la entrada.</h1></header>
<article class="iDevice_wrapper FreeTextfpdIdevice" id="id137">
<div class="iDevice emphasis0">
<div id="ta137_154" class="block iDevice_content">
<p><span style="font-weight: 400;">Los formularios son los elementos principales que permiten el envío de información al servidor, esta información se puede enviar en la url en la querystring, aunque está totalmente desaconsejado y en el cuerpo del mensaje HTTP, en diferentes formatos, indicado en el atributo </span><b>enctype</b><span style="font-weight: 400;">, con los siguientes valores:</span></p>
<ul>
<li aria-level="1" style="font-weight: 400;"><b>application/x-www-form-urlencode</b><span style="font-weight: 400;">d. Pares clave:valor-</span></li>
</ul>
<ul>
<li aria-level="1" style="font-weight: 400;"><b>multipart/form-data</b><span style="font-weight: 400;">: Los datos se envían en bloques separados, útil para enviar ficheros con tipos mime asociados. Un ejemplo de formulario con form-data.</span></li>
</ul>
<div class="highlighted-code language-c">
<div>
<pre><code>POST / HTTP/1.1
Host: localhost:8000
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:29.0) Gecko/20100101 Firefox/29.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Cookie: __atuvc=34%7C7; permanent=0; _gitlab_session=226ad8a0be43681acf38c2fab9497240; __profilin=p%3Dt; request_method=GET
Connection: keep-alive
Content-Type: multipart/form-data; 
boundary=---------------------------9051914041544843365972754266
Content-Length: 554
-----------------------------9051914041544843365972754266
Content-Disposition: form-data; name="text"
text default
-----------------------------9051914041544843365972754266
Content-Disposition: form-data; name="file1"; filename="a.txt"
Content-Type: text/plain
Content of a.txt.
-----------------------------9051914041544843365972754266
Content-Disposition: form-data; name="file2"; filename="a.html"
Content-Type: text/HTML
&lt;!DOCTYPE html&gt;&lt;title&gt;Content of a.html.&lt;/title&gt;
-----------------------------9051914041544843365972754266--</code></pre>
</div>
</div>
<ul>
<li><b>text/plain</b><span style="font-weight: 400;">: Texto plano utilizado para envío de xml o json, recordar añadir la cabecera de content-type.</span></li>
</ul>
<p><span style="font-weight: 400;">Estos formularios posee una serie de etiquetas html que permiten introducir los datos de forma gráfica como:</span></p>
<ul>
<li aria-level="1" style="font-weight: 400;"><span style="font-weight: 400;">Cuadros de texto.</span></li>
<li aria-level="1" style="font-weight: 400;"><span style="font-weight: 400;">Botones de radio.</span></li>
<li aria-level="1" style="font-weight: 400;"><span style="font-weight: 400;">Cuadros desplegables.</span></li>
<li aria-level="1" style="font-weight: 400;"><span style="font-weight: 400;">Ficheros.</span></li>
<li aria-level="1" style="font-weight: 400;"><span style="font-weight: 400;">Áreas de texto.</span></li>
<li aria-level="1" style="font-weight: 400;"><span style="font-weight: 400;">Botones.</span></li>
<li aria-level="1" style="font-weight: 400;"><span style="font-weight: 400;">…</span></li>
</ul>
<p><span style="font-weight: 400;">Estos formularios son los puntos de entrada que van a permitir muchos de los ataques de la lista Top Ten además de ser el objetivo de los casos de prueba para la certificación de seguridad de la aplicación. Es necesario que los formularios y en especial el tratamiento en el servidor sea exhaustivo y no permita acciones no permitidas, evitando por ejemplo la inyección de código malicioso como ataques XSS o inyecciones.</span></p>
</div>
</div>
</article>
<article class="iDevice_wrapper ParasabermasfpdIdevice em_iDevice em_iDevice_parasabermasfpd" id="id138">
<div class="iDevice emphasis_parasabermasfpd" >
<header class="iDevice_header"><h1 class="iDeviceTitle">Para saber más</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta138_128" class="block iDevice_content">
<p>Manual de introducción a los formularios web de W3 School.</p>
<p style="text-align: center;"><a onclick="window.open(this.href,'eXeLearningPopup','scrollbars=yes,resizable=yes,width=800,height=600,left='+(screen.availWidth/2-400)+',top='+(screen.availHeight/2-300)+'');return false;" href="https://www.w3schools.com/tags/tag_form.asp">https://www.w3schools.com/tags/tag_form.asp</a></p>
<p><span style="background-color: #ffffff;"></span></p>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper DestacadofpdIdevice" id="id235">
<div class="iDevice emphasis0" >
<div class="iDevice_destacadofpd">
<div id="ta235_151" class="block iDevice_content">
<p><span style="font-weight: 400;">La tarea de validación de entradas que impida los ataques se ha de realizar tanto en el cliente utilizando javascript nativo o haciendo uso de librerías y entornos de trabajo antes del envío de los datos, como especialmente en el servidor como paso previo al tratamiento de los datos y la aplicación de la lógica de negocio.</span></p>
<p><span style="font-weight: 400;">WSTG de OWASP establece en su capítulo 4 sección 7 una serie de requerimientos de validación y pruebas para la validación de la entrada y prueba de protección ante diferentes ataques como XSS y en especial la inyección de dependencias en las principales bases de datos así cmo en LDAP,XML o XPath.</span></p>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper CasopracticofpdIdevice em_iDevice em_iDevice_casopracticofpd" id="id236">
<div class="iDevice emphasis_casopracticofpd" >
<header class="iDevice_header"><h1 class="iDeviceTitle">Caso práctico</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta236_147" class="block iDevice_content">
<p>Buscar los escenarios en WSTG relacionados con la validación de formularios.</p>
</div>
</div>
</div>
</div>
</article>
</section>
</div>
<div id='bottomPagination'>
<nav class="pagination noprt">
<a href="310__registro_y_monitoreo_insuficientes.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="41__validacin_en_el_cliente.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
</div>
<script type="text/javascript" src="_intef_js.js"></script></body></html>